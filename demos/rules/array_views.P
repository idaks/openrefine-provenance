print_source_uri(DatasetId) :-
    import_state(SourceUri, DatasetId, _, _),
    writeln(SourceUri).

print_column_names(StateId) :-
    column_schema(_, _, StateId, _, ColumnName, _, _),
    writeln(ColumnName),
    fail;
    true.

% RULE : next_column_schema_at_or_before_state/2
%
% Succeeds if a column schema follows the one identified by ColumnSchemaId,
% and the later column schema was created at StateId or earlier.
%
next_column_schema_at_or_before_state(ColumnSchemaId, StateId) :-
    column_schema(_, _, NextColumnSchemaStateId, _, _, _, ColumnSchemaId),
    NextColumnSchemaStateId =< StateId.


% RULE : column_name_at_state/3
%
% Returns ColumnName for ColumnId at the latest state at or before StateId.
%
column_name_at_state(ColumnId, StateId, ColumnName) :-
    column_schema(ColumnSchemaId, ColumnId, CoumnSchemaStateId, _, ColumnName, _, _),
    StateId >= CoumnSchemaStateId,
    not next_column_schema_at_or_before_state(ColumnSchemaId, StateId).

final_array_state(ArrayId, FinalStateId) :-
    state(FinalStateId, ArrayId, _),
    not state(_, ArrayId, FinalStateId).
