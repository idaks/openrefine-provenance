print_source_uri(DatasetId) :-
    import_state(SourceUri, DatasetId, _, _),
    writeln(SourceUri).

print_column_names(StateId) :-
    column_schema(_, _, StateId, _, ColumnName, _, _),
    writeln(ColumnName),
    fail;
    true.

next_column_schema_at_or_before_state(PreviousColumnSchemaId, TargetStateId) :-
    column_schema(_, _, StateId, _, _, _, PreviousColumnSchemaId),
    StateId =< TargetStateId.

column_name_at_state(ColumnId, TargetStateId, ColumnName) :-
    column_schema(ColumnSchemaId, ColumnId, StateId, _, ColumnName, _, _),
    TargetStateId >= StateId,
    not next_column_schema_at_or_before_state(ColumnSchemaId, TargetStateId).

final_array_state(ArrayId, FinalStateId) :-
    state(FinalStateId, ArrayId, _),
    not state(_, ArrayId, FinalStateId).
