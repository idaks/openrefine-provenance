
%print_source_uri(DatasetId) :-
%    import_state(SourceUri, DatasetId, _, _),
%    writeln(SourceUri).

%print_remainder_of_row(RowId, StateId, StartingColumnId) :-
%    cell(CellId, StartingColumnId, RowId),
%    content(_, CellId, _, ValueId, nil),
%    value(ValueId, ValueText),
%    fmt_write('| %s ', ValueText).

%print_row(RowId, StateId) :-
%    first_column(StateId, FirstColumnId, _),
%    print_remainder_of_row(RowId, StateId, FirstColumnId),
%    writeln('|').

%array_header_remainder(StateId, SchemaIdForPreviousColumn, HeaderUpToPreviousColumn, CompleteHeader) :-
%    fmt_write('array_header_remainder ->  SchemaIdForPreviousColumn = %S  HeaderUpToPreviousColumn = %S \n',
%        arg(SchemaIdForPreviousColumn, HeaderUpToPreviousColumn)),
%    schema_of_previous_column(ColumnSchemaId, SchemaIdForPreviousColumn, StateId),
%    column_schema(ColumnSchemaId, _, _, _, ColumnName, _, _),
%    fmt_write('array_header_remainder ->  ColumnSchemaId = %S  ColumnName = %S \n',
%        arg(ColumnSchemaId, ColumnName)),
%    fmt_write_string(HeaderUpToCurrentColumn, "%s %s |", arg(HeaderUpToPreviousColumn, ColumnName)),
%    array_header_remainder(StateId, ColumnSchemaId, HeaderUpToCurrentColumn, CompleteHeader)
%    ;
%    CompleteHeader = HeaderUpToPreviousColumn.

%array_header(StateId, Header) :-
%    fmt_write('array_header.StateId = %d\n', arg(StateId)),
%    first_column(StateId, _, ColumnSchemaId),
%    column_schema(ColumnSchemaId, _, _, _, ColumnName, _, _),
%    fmt_write_string(HeaderPrefix, "| %s |", arg(ColumnName)),
%    array_header_remainder(StateId, ColumnSchemaId, HeaderPrefix, Header).

array_header_remainder(StateId, ColumnId, HeaderStartingFromNextColumn, CompleteHeader) :-
%    fmt_write('array_header_remainder ->  ColumnId=%S  HeaderStartingFromNextColumn=%S \n',
%        arg(ColumnId, HeaderStartingFromNextColumn)),
    column_schema_at_state(ColumnSchemaId, ColumnId, StateId),
%    fmt_write('array_header_remainder ->  ColumnSchemaId = %S\n',arg(ColumnSchemaId)),
    column_schema(ColumnSchemaId, _, _, _, ColumnName, PrevColumnId, _),
%    fmt_write('array_header_remainder ->  PrevColumnId = %S\n',arg(PrevColumnId)),
    fmt_write_string(HeaderStartingFromCurrentColumn, "| %s %s", arg(ColumnName, HeaderStartingFromNextColumn)),
    array_header_remainder(StateId, PrevColumnId, HeaderStartingFromCurrentColumn, CompleteHeader)
    ;
    CompleteHeader = HeaderStartingFromNextColumn.

array_header(StateId, Header) :-
%    fmt_write('array_header -> StateId=%S\n', arg(StateId)),
    last_column(StateId, ColumnId, ColumnSchemaId),
%    fmt_write('array_header -> ColumnId=%S\n', arg(ColumnId)),
    column_schema(ColumnSchemaId, _, _, _, ColumnName, PrevColumnId, _),
%    fmt_write('array_header -> ColumnId=%S ColumnSchemaId=%S ColumnName=%S\n',arg(ColumnId, ColumnSchemaId, ColumnName)),
    fmt_write_string(HeaderForLastColumn, "| %s |", arg(ColumnName)),
    array_header_remainder(StateId, PrevColumnId, HeaderForLastColumn, Header).
